作业编号
　　上机作业9：连通性 最小生成树

问题描述
　　M国由分布在海上的n个小岛组成。期初这些小岛之间都没有桥梁连接，往来全部靠船只。随着时间的推移，M国的科技和经济逐渐得到发展，聪明的工程师在这些岛屿之间逐渐修建了许多桥梁，极大地解决了通行难题。
　　由于修筑的桥梁太多了，M国的交通部门希望你帮忙解决3个难题：
　　1、还需要的桥梁数
　　每隔一段时间M国就会修一座桥，但可能还是会有不少的岛屿之间不能通达。
　　M国的交通部门希望你帮忙求出每一座桥梁修好之后，至少还需要修建多少座桥才能使得任何两个岛屿之间都可以通过桥梁到达。
　　2、最大的收益
　　由于桥梁数量众多，M国的交通部门希望选择其中的一部分收取过路费以支持新桥梁的建设。为了保证普通民众的交通，需要保留一部分的免费桥梁，其原则是：如果一个人从任何一个岛屿出发，能通过桥梁到达的某个岛屿，则他必须可以只通过免费的桥梁到达这个岛屿。
　　M国的交通部门希望你帮忙求出每一座桥梁修好之后，对全国的桥梁采取最优方案，每天最多可以收取多少过路费。
　　值得注意的是，每座桥梁每天可以收取的过路费是一个定值，不会因为其他条件发生变化而改变。
　　由于新的桥梁往往科技含量更高，也会带来更大的便利，因此新修建的桥梁每天可以收取的过路费数量一定不小于原先修建的桥梁，并且不会有超过2座桥梁能收取的费用相同。
　　3、最大收益的方案数
　　有时候选择不同的桥梁收取过路费，会获得相同的每日收益。M国的交通部门希望横向对比一下所有不同的最优方案的情况。但他们发现方案数实在是太多了，可能连32位整型变量都存不下来。他们想让你用程序帮忙计算可以获得最大收益的方案数除以1000000007（10^9+7）的余数。

输入描述
　　输入第一行包含两个空格隔开的正整数n,m，表示岛屿的数量和桥梁的总数。岛屿用1~n的整数编号。
　　接下来m行，每行包含3个整数u,v,w，表示编号接下来要修建一座桥梁，连接了岛屿u和岛屿v，如果这座桥梁收费每天能收取w。
　　保证u和v一定是1~n的整数，但不保证u和v不同（即可能有岛屿存在通往自己的桥梁），也不保证u和v的组合不会重复（同样一对岛屿之间可能会修建多座桥梁）。
　　保证后出现的w一定不小于先出现的w，且相同的w不会超过2个。保证w是不超过10^9的非负整数（某些结果你可能需要使用64位整数存储）。

输出描述
　　输出m行，每行包含3个整数。其中第i行的3个整数分别表示：修建了前i座桥以后要连接所有岛屿至少还需要修建的桥梁数，前i座桥梁每天最多可以收取的过路费数量，前i座桥梁能收取最多过路费的方案数。
子任务
　　这个题目除不同数据包含不同的子任务外，同一组数据的不同问题也是分开评分的。
　　对于每个测试点，如果输出的格式不正确（不是m行，每行3个整数），将不得分；如果格式正确，如果每列的第一个数全部正确，可以得到40%的分数；第二个数、第三个数全部正确可以分别得到40%和20%的分数。
　　此外，不同的测试点分为5个子任务，每个子任务占20%，其区别为n、m的规模不同：
　　每个子任务中，都有一半的测试点满足不会有桥梁的过路费是相同的，也就是说w一定是严格递增的。

样例1输入
　　3 6
　　1 2 1
　　1 2 1
　　1 2 2
　　1 3 2
　　2 3 2
　　1 3 3

样例1输出
　　1 0 1
　　1 1 2
　　1 3 2
　　0 3 2
　　0 5 4
　　0 8 4

样例1解释
　　注意这组样例不满足题目中同一个费用的桥梁数不超过2的限制，但可以用来理解题意。如果这个问题影响了你，可以使用样例2调试。
　　在修筑了前2座桥以后，岛屿1和岛屿2可以互相通达，但都不能到达3，因此只需要再修建1座桥梁就能到达3；前2座桥梁任选一座收费，另外一座桥梁免费都可以保证岛屿1和岛屿2能“只通过免费道路通达”，因此每天可以获得收益1；这2座桥选择任何一座都能达到收益1，因此方案数为2。
　　所有桥都修筑好以后，共有4种方案都可以使得收益达到最大值8。每种方案中，免费桥的编号分别为（从1开始编号）：1和4，1和5，2和4，2和5。

样例2输入
　　5 25
　　2 1 59070660
　　1 2 59070660
　　1 5 97703063
　　4 3 187421498
　　3 4 187421498
　　5 3 249543764
　　4 4 300660063
　　3 4 328792822
　　5 4 328792822
　　2 5 467754874
　　3 1 545220116
　　2 4 545220116
　　2 4 636117562
　　4 1 636117562
　　3 4 725815170
　　5 5 734973098
　　2 3 774242921
　　2 3 800249568
　　4 2 881673674
　　4 1 907064045
　　1 2 907064045
　　2 4 946016517
　　4 4 946016517
　　3 2 962544085
　　3 3 986051969

样例2输出
　　3 0 1
　　3 59070660 2
　　2 59070660 2
　　1 59070660 2
　　1 246492158 4
　　0 246492158 4
　　0 547152221 4
　　0 875945043 4
　　0 1204737865 4
　　0 1672492739 4
　　0 2217712855 4
　　0 2762932971 4
　　0 3399050533 4
　　0 4035168095 4
　　0 4760983265 4
　　0 5495956363 4
　　0 6270199284 4
　　0 7070448852 4
　　0 7952122526 4
　　0 8859186571 4
　　0 9766250616 4
　　0 10712267133 4
　　0 11658283650 4
　　0 12620827735 4
　　0 13606879704 4

提示
　　请使用比较快速的输入输出方式。
　　前两个问题分别与连通性和最小生成树有关，直接计算有困难可以考虑计算“总数减去要计算的值”。
　　第三个问题要充分利用“新修建的桥梁每天可以收取的过路费数量一定不小于原先修建的桥梁，并且不会有超过2座桥梁能收取的费用相同”的条件，如果无法下手可以先尝试解决“不会有桥梁的过路费是相同的”的子问题。
